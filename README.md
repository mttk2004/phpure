# phpure

phpure lÃ  má»™t framework MVC Ä‘Æ¡n giáº£n Ä‘Æ°á»£c viáº¿t báº±ng PHP Ä‘á»ƒ giÃºp ngÆ°á»i má»›i há»c vÃ  khÃ¡m phÃ¡ cÃ¡ch hoáº¡t
Ä‘á»™ng bÃªn trong cá»§a má»™t á»©ng dá»¥ng web theo mÃ´ hÃ¬nh MVC.

---

## **Gáº·p Gá»¡ `phpure`** âœŒï¸

Trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn á»©ng dá»¥ng web, báº¡n sáº½ nhanh chÃ³ng nháº­n ra ráº±ng viá»‡c tá»• chá»©c mÃ£ nguá»“n
má»™t cÃ¡ch cÃ³ cáº¥u trÃºc lÃ  Ä‘iá»u khÃ´ng thá»ƒ thiáº¿u. Ban Ä‘áº§u, báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u vá»›i nhá»¯ng file PHP Ä‘Æ¡n
giáº£n, nhÆ°ng khi á»©ng dá»¥ng cá»§a báº¡n lá»›n dáº§n, mÃ£ nguá»“n sáº½ trá»Ÿ nÃªn khÃ³ kiá»ƒm soÃ¡t, khÃ³ báº£o trÃ¬ vÃ  dá»…
xáº£y ra lá»—i. ÄÃ¢y chÃ­nh lÃ  lÃ½ do táº¡i sao báº¡n cáº§n má»™t framework. Framework khÃ´ng chá»‰ cung cáº¥p cho
báº¡n má»™t bá»™ cÃ´ng cá»¥ sáºµn cÃ³ Ä‘á»ƒ xá»­ lÃ½ nhá»¯ng cÃ´ng viá»‡c thÆ°á»ng gáº·p, mÃ  cÃ²n giÃºp báº¡n tuÃ¢n theo cÃ¡c
nguyÃªn táº¯c thiáº¿t káº¿ pháº§n má»m tá»‘t nhÆ° mÃ´ hÃ¬nh MVC (Model-View-Controller). Náº¿u khÃ´ng sá»­ dá»¥ng má»™t
framework ngay tá»« Ä‘áº§u, ráº¥t cÃ³ thá»ƒ báº¡n sáº½ tá»± mÃ¬nh xÃ¢y dá»±ng má»™t há»‡ thá»‘ng tÆ°Æ¡ng tá»± Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c
váº¥n Ä‘á» tá»• chá»©c vÃ  tÃ¡i sá»­ dá»¥ng mÃ£ nguá»“n â€“ vá» báº£n cháº¥t, báº¡n Ä‘ang tá»± táº¡o ra framework cá»§a riÃªng
mÃ¬nh.

NgoÃ i kia, cÃ³ ráº¥t nhiá»u framework PHP máº¡nh máº½ nhÆ° Laravel, Symfony, CodeIgniter, Zend, Yii vÃ  nhiá»u
framework khÃ¡c ná»¯a. Nhá»¯ng cÃ´ng cá»¥ nÃ y mang Ä‘áº¿n vÃ´ vÃ n tÃ­nh nÄƒng há»¯u Ã­ch, giÃºp viá»‡c phÃ¡t triá»ƒn á»©ng
dá»¥ng web trá»Ÿ nÃªn nhanh chÃ³ng vÃ  dá»… dÃ ng hÆ¡n bao giá» háº¿t. Tuy nhiÃªn, Ä‘á»‘i vá»›i nhá»¯ng ngÆ°á»i má»›i báº¯t Ä‘áº§u
há»c PHP, viá»‡c tiáº¿p cáº­n cÃ¡c framework lá»›n thÆ°á»ng lÃ  má»™t thá»­ thÃ¡ch khÃ´ng nhá». CÃ¡c khÃ¡i niá»‡m phá»©c táº¡p
vÃ  há»‡ thá»‘ng tÃ­nh nÄƒng Ä‘á»“ sá»™ Ä‘Ã´i khi cÃ³ thá»ƒ khiáº¿n há» cáº£m tháº¥y choÃ¡ng ngá»£p, tháº­m chÃ­ lÃ m giáº£m há»©ng thÃº
há»c táº­p. Báº£n thÃ¢n tÃ´i cÅ©ng tá»«ng tráº£i qua cáº£m giÃ¡c nÃ y khi láº§n Ä‘áº§u lÃ m quen vá»›i
[Laravel](https://laravel.com). Vá»›i má»™t ngÆ°á»i má»›i nhÆ° tÃ´i thá»i Ä‘iá»ƒm Ä‘Ã³, Laravel dÆ°á»ng nhÆ° lÃ  má»™t tháº¿
giá»›i Ä‘áº§y "phÃ©p thuáº­t" khÃ³ hiá»ƒu vÃ  Ä‘Ã²i há»i nhiá»u ná»— lá»±c Ä‘á»ƒ chinh phá»¥c.

VÃ o Ä‘áº§u nÄƒm 2025, khi bÆ°á»›c vÃ o há»c ká»³ má»›i, tÃ´i cÃ³ cÆ¡ há»™i tham gia má»™t mÃ´n há»c ráº¥t thÃº vá»‹ mang
tÃªn "Láº­p trÃ¬nh Web vÃ  á»¨ng dá»¥ng nÃ¢ng cao". Má»™t trong nhá»¯ng yÃªu cáº§u quan trá»ng cá»§a mÃ´n há»c lÃ  xÃ¢y
dá»±ng má»™t á»©ng dá»¥ng web PHP thuáº§n tÃºy (Pure PHP) theo mÃ´ hÃ¬nh MVC mÃ  khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng báº¥t ká»³
framework lá»›n nÃ o nhÆ° Laravel. ÄÃ¢y lÃ  má»™t bÃ i táº­p cÃ³ Ã½ nghÄ©a nháº±m giÃºp chÃºng tÃ´i hiá»ƒu rÃµ cÃ¡ch
cÃ¡c thÃ nh pháº§n cá»§a á»©ng dá»¥ng web hoáº¡t Ä‘á»™ng tá»« gá»‘c rá»…. Nháº­n tháº¥y Ä‘Ã¢y lÃ  cÆ¡ há»™i tuyá»‡t vá»i Ä‘á»ƒ há»c há»i vÃ 
thá»­ nghiá»‡m, tÃ´i Ä‘Ã£ quyáº¿t Ä‘á»‹nh báº¯t tay vÃ o phÃ¡t triá»ƒn `phpure` â€” **má»™t framework PHP Ä‘Æ¡n giáº£n, gá»n
nháº¹ nhÆ°ng Ä‘á»§ máº¡nh máº½** Ä‘á»ƒ há»— trá»£ ngÆ°á»i má»›i báº¯t Ä‘áº§u dá»… dÃ ng náº¯m báº¯t cÃ¡ch xÃ¢y dá»±ng á»©ng dá»¥ng web theo
mÃ´ hÃ¬nh MVC.

TÃ´i lÃ  [Mai Tráº§n Tuáº¥n Kiá»‡t](https://github.com/mttk2004), má»™t sinh viÃªn chuyÃªn ngÃ nh PhÃ¡t triá»ƒn Web,
vÃ  `phpure` chÃ­nh lÃ  dá»± Ã¡n mÃ£ nguá»“n má»Ÿ Ä‘áº§u tay cá»§a tÃ´i. TÃ´i ráº¥t vui má»«ng Ä‘Æ°á»£c chia sáº» dá»± Ã¡n nÃ y vá»›i
cá»™ng Ä‘á»“ng.

Äiá»u Ä‘áº·c biá»‡t á»Ÿ `phpure` lÃ  nÃ³ **Ä‘Æ°á»£c thiáº¿t káº¿ hÆ°á»›ng Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng ngÆ°á»i má»›i há»c**. Framework nÃ y
mang tÃ­nh Ä‘Æ¡n giáº£n, trá»±c quan, dá»… hiá»ƒu vÃ  dá»… sá»­ dá»¥ng. Náº¿u báº¡n Ä‘ang tÃ¬m hiá»ƒu vá» PHP hoáº·c muá»‘n
hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a má»™t á»©ng dá»¥ng web theo mÃ´ hÃ¬nh MVC, `phpure` cháº¯c cháº¯n sáº½ lÃ  má»™t cÃ´ng cá»¥
há»¯u Ã­ch. HÆ¡n ná»¯a, náº¿u sau nÃ y báº¡n cÃ³ Ã½ Ä‘á»‹nh há»c cÃ¡c framework lá»›n nhÆ° Laravel, viá»‡c hiá»ƒu rÃµ cÃ¡ch
váº­n hÃ nh cá»§a `phpure` sáº½ giÃºp báº¡n cÃ³ ná»n táº£ng vá»¯ng cháº¯c Ä‘á»ƒ tiáº¿p cáº­n nhá»¯ng khÃ¡i niá»‡m nÃ¢ng cao hÆ¡n.
Tháº­t váº­y, `phpure` Ä‘Æ°á»£c **láº¥y cáº£m há»©ng tá»« cáº¥u trÃºc cá»§a Laravel** nhÆ°ng Ä‘Æ°á»£c tá»‘i giáº£n hÃ³a Ä‘á»ƒ phÃ¹ há»£p
hÆ¡n vá»›i nhá»¯ng ngÆ°á»i má»›i báº¯t Ä‘áº§u. LÃ  má»™t ngÆ°á»i yÃªu thÃ­ch Laravel, tÃ´i Ä‘Ã£ cá»‘ gáº¯ng mang nhá»¯ng yáº¿u tá»‘
tinh táº¿ nháº¥t cá»§a framework nÃ y vÃ o `phpure` Ä‘á»ƒ mang Ä‘áº¿n tráº£i nghiá»‡m há»c táº­p vÃ  láº­p trÃ¬nh tá»‘t nháº¥t.

KhÃ´ng chá»‰ giá»›i háº¡n á»Ÿ cÃ¡c á»©ng dá»¥ng web Ä‘Æ¡n giáº£n, `phpure` cÃ²n cÃ³ **kháº£ nÄƒng má»Ÿ rá»™ng vÃ  tÃ¹y chá»‰nh
linh hoáº¡t** Ä‘á»ƒ phÃ¹ há»£p vá»›i nhu cáº§u phÃ¡t triá»ƒn cá»§a báº¡n. TÃ´i tin ráº±ng, vá»›i má»™t cÃ´ng cá»¥ nhÆ° `phpure`,
hÃ nh trÃ¬nh há»c há»i vÃ  xÃ¢y dá»±ng á»©ng dá»¥ng web cá»§a báº¡n sáº½ trá»Ÿ nÃªn dá»… dÃ ng vÃ  thÃº vá»‹ hÆ¡n ráº¥t nhiá»u.

HÃ£y thá»­ khÃ¡m phÃ¡ `phpure` ngay hÃ´m nay vÃ  cÃ¹ng nhau táº¡o nÃªn nhá»¯ng á»©ng dá»¥ng web tuyá»‡t vá»i! ğŸŒŸ

---

## **Báº¯t Äáº§u** â›¹ï¸

### **1. CÃ i Ä‘áº·t** ğŸ“¥

#### **YÃªu cáº§u há»‡ thá»‘ng**

TrÆ°á»›c khi báº¯t Ä‘áº§u cÃ i Ä‘áº·t vÃ  sá»­ dá»¥ng `phpure`, hÃ£y Ä‘áº£m báº£o ráº±ng mÃ´i trÆ°á»ng lÃ m viá»‡c cá»§a báº¡n Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u sau:

- **PHP**: Tá»‘i thiá»ƒu phiÃªn báº£n 8.0.
- **Composer**: Tá»‘i thiá»ƒu phiÃªn báº£n 2.8.4.
- **npm**: Tá»‘i thiá»ƒu phiÃªn báº£n 11.0.0.

Viá»‡c Ä‘áº£m báº£o cÃ¡c cÃ´ng cá»¥ trÃªn Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t Ä‘Ãºng phiÃªn báº£n khÃ´ng chá»‰ giÃºp báº¡n trÃ¡nh gáº·p pháº£i lá»—i trong quÃ¡ trÃ¬nh cÃ i Ä‘áº·t mÃ  cÃ²n Ä‘áº£m báº£o á»©ng dá»¥ng hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh.

---

#### **CÃ¡c bÆ°á»›c cÃ i Ä‘áº·t**

Báº¯t Ä‘áº§u báº±ng cÃ¡ch má»Ÿ terminal hoáº·c command prompt vÃ  thá»±c hiá»‡n cÃ¡c lá»‡nh sau:

```bash
git clone https://github.com/mttk2004/phpure.git
cd phpure
```

- **`git clone`**: Táº£i toÃ n bá»™ mÃ£ nguá»“n `phpure` tá»« GitHub vá» mÃ¡y tÃ­nh cá»§a báº¡n.
- **`cd phpure`**: Äiá»u hÆ°á»›ng Ä‘áº¿n thÆ° má»¥c chá»©a mÃ£ nguá»“n vá»«a táº£i vá».

Sau khi hoÃ n thÃ nh bÆ°á»›c nÃ y, báº¡n Ä‘Ã£ sáºµn sÃ ng tiáº¿p tá»¥c vá»›i cÃ¡c bÆ°á»›c thiáº¿t láº­p dá»± Ã¡n vÃ  cÃ i Ä‘áº·t phá»¥ thuá»™c.

---

### **2. Cáº¥u hÃ¬nh** âš™ï¸

Äá»ƒ `phpure` hoáº¡t Ä‘á»™ng chÃ­nh xÃ¡c, báº¡n cáº§n thá»±c hiá»‡n má»™t sá»‘ bÆ°á»›c cáº¥u hÃ¬nh cÆ¡ báº£n sau khi táº£i mÃ£ nguá»“n.

---

#### **CÃ i Ä‘áº·t phá»¥ thuá»™c**

Sá»­ dá»¥ng cÃ¡c lá»‡nh sau Ä‘á»ƒ cÃ i Ä‘áº·t toÃ n bá»™ cÃ¡c gÃ³i phá»¥ thuá»™c cáº§n thiáº¿t:

```bash
composer install
npm install
```

- **`composer install`**: Táº£i vá» táº¥t cáº£ cÃ¡c thÆ° viá»‡n PHP cáº§n thiáº¿t Ä‘á»ƒ dá»± Ã¡n hoáº¡t Ä‘á»™ng.
- **`npm install`**: CÃ i Ä‘áº·t cÃ¡c gÃ³i front-end há»— trá»£ giao diá»‡n hoáº·c cÃ¡c cÃ´ng cá»¥ build.

Hai lá»‡nh nÃ y sáº½ Ä‘áº£m báº£o ráº±ng báº¡n cÃ³ Ä‘áº§y Ä‘á»§ cÃ´ng cá»¥ Ä‘á»ƒ phÃ¡t triá»ƒn vÃ  váº­n hÃ nh á»©ng dá»¥ng.

---

#### **Cáº¥u hÃ¬nh file `.env`**

Dá»± Ã¡n sá»­ dá»¥ng file `.env` Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c thÃ´ng tin cáº¥u hÃ¬nh quan trá»ng nhÆ° thÃ´ng tin cÆ¡ sá»Ÿ dá»¯ liá»‡u, mÃ´i trÆ°á»ng á»©ng dá»¥ng, vÃ  cÃ¡c thÃ´ng sá»‘ khÃ¡c. Äá»ƒ táº¡o file `.env`, thá»±c hiá»‡n lá»‡nh sau:

```bash
cp .env.example .env
```

Tiáº¿p theo, má»Ÿ file `.env` vá»«a táº¡o vÃ  cáº­p nháº­t cÃ¡c thÃ´ng sá»‘ phÃ¹ há»£p vá»›i mÃ´i trÆ°á»ng cá»§a báº¡n. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» cáº¥u hÃ¬nh cÆ¡ sá»Ÿ dá»¯ liá»‡u:

```env
# APP
APP_ENV=development

# DATABASE
DB_ADAPTER=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_NAME=my_database
DB_USER=root
DB_PASS=
DB_CHARSET=utf8mb4
```

Má»™t vÃ i lÆ°u Ã½ quan trá»ng:

- File `.env` chá»©a cÃ¡c thÃ´ng tin nháº¡y cáº£m, nhÆ° máº­t kháº©u cÆ¡ sá»Ÿ dá»¯ liá»‡u, nÃªn báº¡n cáº§n báº£o máº­t vÃ  trÃ¡nh chia sáº» cÃ´ng khai.
- `phpure` Ä‘Ã£ tá»± Ä‘á»™ng thÃªm `.env` vÃ o `.gitignore`, giÃºp báº¡n trÃ¡nh táº£i file nÃ y lÃªn GitHub.

---

#### **Cáº¥u hÃ¬nh Phinx**

`phpure` sá»­ dá»¥ng **Phinx**, má»™t cÃ´ng cá»¥ quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u máº¡nh máº½, Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ nhÆ° táº¡o báº£ng, thÃªm cá»™t, hoáº·c sá»­a Ä‘á»•i cáº¥u trÃºc cÆ¡ sá»Ÿ dá»¯ liá»‡u.

Cáº¥u hÃ¬nh cá»§a Phinx Ä‘Æ°á»£c lÆ°u trong file `phinx.php`. Tuy nhiÃªn, báº¡n khÃ´ng cáº§n chá»‰nh sá»­a trá»±c tiáº¿p file nÃ y vÃ¬ táº¥t cáº£ thÃ´ng tin Ä‘Ã£ Ä‘Æ°á»£c tá»± Ä‘á»™ng cáº¥u hÃ¬nh thÃ´ng qua file `.env`.

Phinx lÃ  má»™t pháº§n quan trá»ng trong viá»‡c quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a `phpure`. NÃ³ giÃºp tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh, giáº£m thiá»ƒu cÃ¡c thao tÃ¡c thá»§ cÃ´ng vÃ  Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n. Trong pháº§n tiáº¿p theo, chÃºng ta sáº½ Ä‘i sÃ¢u hÆ¡n vÃ o cÃ¡ch sá»­ dá»¥ng Phinx Ä‘á»ƒ quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡u quáº£.

---

HoÃ n thÃ nh cÃ¡c bÆ°á»›c trÃªn, báº¡n Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ báº¯t Ä‘áº§u hÃ nh trÃ¬nh phÃ¡t triá»ƒn vá»›i `phpure`! ğŸš€

### **3. Cáº¥u trÃºc thÆ° má»¥c** ğŸ“‚

Tiáº¿p theo, hÃ£y tÃ¬m hiá»ƒu cáº¥u trÃºc thÆ° má»¥c cá»§a `phpure` Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch tá»• chá»©c vÃ  quáº£n lÃ½ dá»± Ã¡n.

Cáº¥u trÃºc thÆ° má»¥c cá»§a **phpure** Ä‘Æ°á»£c thiáº¿t káº¿ nháº±m **Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n, dá»… hiá»ƒu, vÃ  kháº£ nÄƒng
má»Ÿ rá»™ng tá»‘i Æ°u**. MÃ´ hÃ¬nh MVC (Model-View-Controller) Ä‘Æ°á»£c Ã¡p dá»¥ng lÃ m ná»n táº£ng, giÃºp tÃ¡ch biá»‡t
cÃ¡c thÃ nh pháº§n xá»­ lÃ½ logic, giao diá»‡n, vÃ  dá»¯ liá»‡u má»™t cÃ¡ch rÃµ rÃ ng. Äiá»u nÃ y khÃ´ng chá»‰ giÃºp quáº£n lÃ½ dá»± Ã¡n hiá»‡u quáº£ mÃ  cÃ²n táº¡o tiá»n Ä‘á» Ä‘á»ƒ má»Ÿ rá»™ng khi á»©ng dá»¥ng phÃ¡t triá»ƒn.

#### **ThÆ° má»¥c `app/`**

ThÆ° má»¥c nÃ y chá»©a pháº§n lá»›n logic á»©ng dá»¥ng. CÃ¡c thÃ nh pháº§n trong thÆ° má»¥c nÃ y bao gá»“m:

- `Controllers/`: Chá»©a cÃ¡c lá»›p controller xá»­ lÃ½ logic cá»§a á»©ng dá»¥ng, nháº­n yÃªu cáº§u tá»« ngÆ°á»i dÃ¹ng, thá»±c thi logic vÃ  tráº£ vá» pháº£n há»“i.
- `Listeners/`: Táº­p há»£p cÃ¡c lá»›p láº¯ng nghe vÃ  xá»­ lÃ½ sá»± kiá»‡n do á»©ng dá»¥ng hoáº·c há»‡ thá»‘ng kÃ­ch hoáº¡t.
- `Middlewares/`: Chá»©a cÃ¡c lá»›p middleware Ä‘á»ƒ xá»­ lÃ½ yÃªu cáº§u HTTP trÆ°á»›c hoáº·c sau khi Ä‘áº¿n controller (nhÆ° xÃ¡c thá»±c, kiá»ƒm tra quyá»n truy cáº­p).
- `Models/`: Chá»©a cÃ¡c lá»›p model chá»‹u trÃ¡ch nhiá»‡m tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, quáº£n lÃ½ dá»¯ liá»‡u á»©ng dá»¥ng.
- `events.php`: File Ä‘Äƒng kÃ½ vÃ  quáº£n lÃ½ cÃ¡c sá»± kiá»‡n cá»§a á»©ng dá»¥ng, giÃºp báº¡n dá»… dÃ ng káº¿t ná»‘i sá»± kiá»‡n vá»›i cÃ¡c listener tÆ°Æ¡ng á»©ng.
- `routes.php`: File Ä‘á»‹nh nghÄ©a táº¥t cáº£ cÃ¡c tuyáº¿n Ä‘Æ°á»ng (routes) cá»§a á»©ng dá»¥ng, Ã¡nh xáº¡ URL tá»›i controller vÃ  phÆ°Æ¡ng thá»©c tÆ°Æ¡ng á»©ng.

#### **ThÆ° má»¥c `core/`**

ÄÃ¢y lÃ  pháº§n "xÆ°Æ¡ng sá»‘ng" cá»§a framework, chá»©a cÃ¡c lá»›p cá»‘t lÃµi:

- `Http/`:
  - `Middleware.php`: Quáº£n lÃ½ vÃ  Ä‘Äƒng kÃ½ cÃ¡c middleware.
  - `Request.php`: Xá»­ lÃ½ thÃ´ng tin tá»« yÃªu cáº§u HTTP, bao gá»“m dá»¯ liá»‡u GET, POST vÃ  thÃ´ng tin tiÃªu Ä‘á» (headers).
  - `Response.php`: Táº¡o pháº£n há»“i HTTP vÃ  gá»­i chÃºng Ä‘áº¿n trÃ¬nh duyá»‡t ngÆ°á»i dÃ¹ng.
  - `ResponseCode.php`: Äá»‹nh nghÄ©a cÃ¡c mÃ£ tráº¡ng thÃ¡i HTTP phá»• biáº¿n nhÆ° 200, 404, 500, ...
  - `Router.php`: Há»‡ thá»‘ng Ä‘á»‹nh tuyáº¿n, Ã¡nh xáº¡ cÃ¡c yÃªu cáº§u URL Ä‘áº¿n controller vÃ  phÆ°Æ¡ng thá»©c tÆ°Æ¡ng á»©ng.
- `App.php`: Lá»›p cá»‘t lÃµi khá»Ÿi Ä‘á»™ng vÃ  quáº£n lÃ½ toÃ n bá»™ á»©ng dá»¥ng, káº¿t ná»‘i cÃ¡c thÃ nh pháº§n vá»›i nhau.
- `Controller.php`: Lá»›p cÆ¡ sá»Ÿ cho táº¥t cáº£ cÃ¡c controller, cung cáº¥p cÃ¡c chá»©c nÄƒng cÆ¡ báº£n nhÆ° render view.
- `Database.php`: Quáº£n lÃ½ káº¿t ná»‘i cÆ¡ sá»Ÿ dá»¯ liá»‡u, thá»±c hiá»‡n cÃ¡c truy váº¥n SQL vÃ  xá»­ lÃ½ dá»¯ liá»‡u.
- `Event.php`: Há»— trá»£ há»‡ thá»‘ng sá»± kiá»‡n, cho phÃ©p kÃ­ch hoáº¡t vÃ  láº¯ng nghe cÃ¡c sá»± kiá»‡n.
- `ExceptionHandler.php`: Quáº£n lÃ½ vÃ  xá»­ lÃ½ cÃ¡c lá»—i (exception) xáº£y ra trong á»©ng dá»¥ng.
- `Logger.php`: Ghi log thÃ´ng tin, lá»—i, vÃ  sá»± kiá»‡n quan trá»ng Ä‘á»ƒ theo dÃµi hoáº¡t Ä‘á»™ng cá»§a á»©ng dá»¥ng.
- `Model.php`: Lá»›p cÆ¡ sá»Ÿ cho cÃ¡c model, há»— trá»£ tÆ°Æ¡ng tÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u thÃ´ng qua ORM hoáº·c truy váº¥n SQL.
- `Session.php`: Quáº£n lÃ½ phiÃªn lÃ m viá»‡c (session), lÆ°u trá»¯ thÃ´ng tin táº¡m thá»i giá»¯a cÃ¡c yÃªu cáº§u cá»§a ngÆ°á»i dÃ¹ng.
- `Storage.php`: Quáº£n lÃ½ lÆ°u trá»¯ file nhÆ° táº£i lÃªn, cache hoáº·c lÆ°u trá»¯ táº¡m thá»i.
- `Twig.php`: TÃ­ch há»£p vÃ  quáº£n lÃ½ template engine Twig, giÃºp táº¡o giao diá»‡n linh hoáº¡t hÆ¡n.
- `Validation.php`: Quáº£n lÃ½ vÃ  thá»±c thi kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o (validation).

#### **ThÆ° má»¥c `database/`**

- `migrations/`: Chá»©a cÃ¡c file quáº£n lÃ½ thay Ä‘á»•i cáº¥u trÃºc cÆ¡ sá»Ÿ dá»¯ liá»‡u (migration), cho phÃ©p Ã¡p dá»¥ng hoáº·c hoÃ n tÃ¡c cÃ¡c thay Ä‘á»•i.
- `seeds/`: Chá»©a cÃ¡c file seeding, dÃ¹ng Ä‘á»ƒ táº¡o dá»¯ liá»‡u máº«u hoáº·c dá»¯ liá»‡u máº·c Ä‘á»‹nh cho á»©ng dá»¥ng.

#### **ThÆ° má»¥c `public/`**

ThÆ° má»¥c nÃ y chá»©a cÃ¡c tá»‡p cÃ´ng khai cÃ³ thá»ƒ truy cáº­p tá»« trÃ¬nh duyá»‡t:

- `assets/`: Chá»©a tÃ i nguyÃªn tÄ©nh nhÆ° CSS, JS, vÃ  hÃ¬nh áº£nh.
- `index.php`: Äiá»ƒm vÃ o chÃ­nh cá»§a á»©ng dá»¥ng, nháº­n vÃ  chuyá»ƒn hÆ°á»›ng táº¥t cáº£ cÃ¡c yÃªu cáº§u tá»›i há»‡ thá»‘ng Ä‘á»‹nh tuyáº¿n.

#### **ThÆ° má»¥c `resources/`**

Táº­p trung vÃ o giao diá»‡n vÃ  tÃ i nguyÃªn giao diá»‡n cá»§a á»©ng dá»¥ng:

- `css/input.css`: Tá»‡p CSS tÃ¹y chá»‰nh, dÃ¹ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a giao diá»‡n.
- `js/app.js`: Tá»‡p JavaScript tÃ¹y chá»‰nh, quáº£n lÃ½ logic giao diá»‡n Ä‘á»™ng.
- `views/`: Chá»©a cÃ¡c file giao diá»‡n (template/view), giÃºp tÃ¡ch biá»‡t hoÃ n toÃ n logic vÃ  giao diá»‡n.

#### **ThÆ° má»¥c `storage/`**

- `cache/`: Chá»©a dá»¯ liá»‡u táº¡m thá»i hoáº·c cache Ä‘Æ°á»£c táº¡o bá»Ÿi á»©ng dá»¥ng.
- `logs/app.log`: Ghi log hoáº¡t Ä‘á»™ng cá»§a á»©ng dá»¥ng.
- `uploads/`: Chá»©a cÃ¡c file ngÆ°á»i dÃ¹ng táº£i lÃªn.

#### **ThÆ° má»¥c `utils/`**

- `helpers.php`: Chá»©a cÃ¡c hÃ m tiá»‡n Ã­ch cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng trÃªn toÃ n bá»™ á»©ng dá»¥ng.

#### **CÃ¡c tá»‡p cáº¥u hÃ¬nh quan trá»ng**

- `.env.example`: File máº«u chá»©a cÃ¡c cáº¥u hÃ¬nh mÃ´i trÆ°á»ng nhÆ° thÃ´ng tin cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c key báº£o máº­t.
- `.gitignore`: Quy Ä‘á»‹nh cÃ¡c file vÃ  thÆ° má»¥c khÃ´ng Ä‘Æ°á»£c theo dÃµi bá»Ÿi Git.
- `.htaccess`: File cáº¥u hÃ¬nh Apache, chuyá»ƒn hÆ°á»›ng má»i yÃªu cáº§u Ä‘áº¿n `index.php`.
- `CODE_OF_CONDUCT.md`: Quy táº¯c á»©ng xá»­ trong dá»± Ã¡n.
- `composer.json`: Danh sÃ¡ch cÃ¡c thÆ° viá»‡n PHP phá»¥ thuá»™c, Ä‘Æ°á»£c quáº£n lÃ½ báº±ng Composer.
- `tailwind.config.js`: File cáº¥u hÃ¬nh Tailwind CSS, Ä‘á»‹nh nghÄ©a cÃ¡c tuá»³ chá»‰nh vá» giao diá»‡n.
- `webpack.config.js`: Cáº¥u hÃ¬nh Webpack Ä‘á»ƒ quáº£n lÃ½ vÃ  Ä‘Ã³ng gÃ³i cÃ¡c tÃ i nguyÃªn nhÆ° CSS, JS.

Vá»›i cáº¥u trÃºc nÃ y, phpure khÃ´ng chá»‰ dá»… sá»­ dá»¥ng mÃ  cÃ²n dá»… má»Ÿ rá»™ng vÃ  báº£o trÃ¬. Má»i thÃ nh pháº§n Ä‘Æ°á»£c tá»• chá»©c cháº·t cháº½ vÃ  rÃµ rÃ ng, táº¡o Ä‘iá»u kiá»‡n cho cÃ¡c láº­p trÃ¬nh viÃªn táº­p trung vÃ o phÃ¡t triá»ƒn mÃ  khÃ´ng bá»‹ phÃ¢n tÃ¡n.

DÆ°á»›i Ä‘Ã¢y lÃ  mÃ´ táº£ chi tiáº¿t vá» tá»«ng thÆ° má»¥c vÃ  file:

```plaintext
phpure/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ Controllers/           # Chá»©a cÃ¡c lá»›p xá»­ lÃ½ logic á»©ng dá»¥ng, nháº­n vÃ  pháº£n há»“i yÃªu cáº§u tá»« ngÆ°á»i dÃ¹ng.
â”‚   â”œâ”€â”€ Listeners/             # Chá»©a cÃ¡c lá»›p láº¯ng nghe vÃ  xá»­ lÃ½ sá»± kiá»‡n trong há»‡ thá»‘ng.
â”‚   â”œâ”€â”€ Middlewares/           # Chá»©a cÃ¡c lá»›p middleware Ä‘á»ƒ xá»­ lÃ½ cÃ¡c yÃªu cáº§u HTTP trÆ°á»›c hoáº·c sau khi tá»›i controller.
â”‚   â”œâ”€â”€ Models/                # Chá»©a cÃ¡c lá»›p mÃ´ hÃ¬nh (model) Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u.
â”‚   â”œâ”€â”€ events.php             # File Ä‘Äƒng kÃ½ vÃ  quáº£n lÃ½ cÃ¡c sá»± kiá»‡n trong á»©ng dá»¥ng.
â”‚   â”œâ”€â”€ routes.php             # File Ä‘á»‹nh nghÄ©a cÃ¡c tuyáº¿n Ä‘Æ°á»ng (route) cho á»©ng dá»¥ng.
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ Http/
â”‚   â”‚   â”œâ”€â”€ Middleware.php     # Lá»›p quáº£n lÃ½ middleware, Ä‘Äƒng kÃ½ vÃ  xá»­ lÃ½ cÃ¡c middleware.
â”‚   â”‚   â”œâ”€â”€ Request.php        # Lá»›p xá»­ lÃ½ thÃ´ng tin tá»« yÃªu cáº§u HTTP (request).
â”‚   â”‚   â”œâ”€â”€ Response.php       # Lá»›p táº¡o vÃ  gá»­i pháº£n há»“i HTTP (response).
â”‚   â”‚   â”œâ”€â”€ ResponseCode.php   # Äá»‹nh nghÄ©a cÃ¡c mÃ£ tráº¡ng thÃ¡i HTTP (HTTP status codes).
â”‚   â”‚   â”œâ”€â”€ Router.php         # Lá»›p Ä‘á»‹nh tuyáº¿n, Ã¡nh xáº¡ yÃªu cáº§u HTTP tá»›i controller.
â”‚   â”œâ”€â”€ App.php                # Lá»›p cá»‘t lÃµi cá»§a framework, khá»Ÿi táº¡o vÃ  quáº£n lÃ½ á»©ng dá»¥ng.
â”‚   â”œâ”€â”€ Controller.php         # Lá»›p cÆ¡ sá»Ÿ cho táº¥t cáº£ cÃ¡c controller, há»— trá»£ render view.
â”‚   â”œâ”€â”€ Database.php           # Lá»›p quáº£n lÃ½ káº¿t ná»‘i cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  truy váº¥n SQL.
â”‚   â”œâ”€â”€ Event.php              # Quáº£n lÃ½ há»‡ thá»‘ng sá»± kiá»‡n (event) vÃ  cÃ¡c listener.
â”‚   â”œâ”€â”€ ExceptionHandler.php   # Xá»­ lÃ½ cÃ¡c lá»—i (exception) xáº£y ra trong á»©ng dá»¥ng.
â”‚   â”œâ”€â”€ Logger.php             # Lá»›p ghi log thÃ´ng tin, lá»—i vÃ  sá»± kiá»‡n quan trá»ng.
â”‚   â”œâ”€â”€ Model.php              # Lá»›p cÆ¡ sá»Ÿ cho táº¥t cáº£ cÃ¡c model, há»— trá»£ ORM.
â”‚   â”œâ”€â”€ Session.php            # Quáº£n lÃ½ phiÃªn lÃ m viá»‡c (session) cá»§a ngÆ°á»i dÃ¹ng.
â”‚   â”œâ”€â”€ Storage.php            # Quáº£n lÃ½ lÆ°u trá»¯ file, nhÆ° táº£i lÃªn hoáº·c lÆ°u cache.
â”‚   â”œâ”€â”€ Twig.php               # TÃ­ch há»£p vÃ  quáº£n lÃ½ template engine Twig.
â”‚   â”œâ”€â”€ Validation.php         # Quáº£n lÃ½ vÃ  thá»±c thi kiá»ƒm tra dá»¯ liá»‡u (validation).
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ migrations/            # Chá»©a cÃ¡c file quáº£n lÃ½ thay Ä‘á»•i cáº¥u trÃºc cÆ¡ sá»Ÿ dá»¯ liá»‡u (migration).
â”‚   â”œâ”€â”€ seeds/                 # Chá»©a cÃ¡c file táº¡o dá»¯ liá»‡u máº«u (seeding).
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ assets/                # Chá»©a cÃ¡c tÃ i nguyÃªn tÄ©nh nhÆ° CSS, JS, vÃ  hÃ¬nh áº£nh.
â”‚   â”œâ”€â”€ index.php              # File khá»Ÿi táº¡o á»©ng dá»¥ng, nháº­n vÃ  chuyá»ƒn hÆ°á»›ng táº¥t cáº£ cÃ¡c yÃªu cáº§u tá»›i há»‡ thá»‘ng Ä‘á»‹nh tuyáº¿n.
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ css/input.css          # Chá»©a file CSS tÃ¹y chá»‰nh cá»§a dá»± Ã¡n.
â”‚   â”œâ”€â”€ js/app.js              # Chá»©a file JavaScript tÃ¹y chá»‰nh cá»§a dá»± Ã¡n.
â”‚   â”œâ”€â”€ views/                 # Chá»©a cÃ¡c file giao diá»‡n (template/view) cá»§a á»©ng dá»¥ng.
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ cache/                 # Chá»©a dá»¯ liá»‡u cache Ä‘Æ°á»£c táº¡o bá»Ÿi á»©ng dá»¥ng.
â”‚   â”œâ”€â”€ logs/app.log           # File ghi log cá»§a á»©ng dá»¥ng.
â”‚   â”œâ”€â”€ uploads/               # Chá»©a cÃ¡c file Ä‘Æ°á»£c táº£i lÃªn tá»« ngÆ°á»i dÃ¹ng.
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ helpers.php            # Chá»©a cÃ¡c hÃ m tiá»‡n Ã­ch Ä‘Æ°á»£c sá»­ dá»¥ng trong toÃ n bá»™ dá»± Ã¡n.
â”œâ”€â”€ .env.example               # File máº«u cáº¥u hÃ¬nh mÃ´i trÆ°á»ng, chá»©a thÃ´ng tin káº¿t ná»‘i vÃ  thiáº¿t láº­p cÆ¡ báº£n.
â”œâ”€â”€ .gitignore                 # File Ä‘á»‹nh nghÄ©a cÃ¡c tá»‡p/thÆ° má»¥c bá»‹ Git bá» qua.
â”œâ”€â”€ .htaccess                  # File cáº¥u hÃ¬nh Apache, chuyá»ƒn hÆ°á»›ng táº¥t cáº£ yÃªu cáº§u tá»›i index.php.
â”œâ”€â”€ CODE_OF_CONDUCT.md         # Quy táº¯c á»©ng xá»­ trong dá»± Ã¡n.
â”œâ”€â”€ composer.json              # File cáº¥u hÃ¬nh Composer, liá»‡t kÃª cÃ¡c thÆ° viá»‡n phá»¥ thuá»™c.
â”œâ”€â”€ LICENSE                    # File chá»©a thÃ´ng tin báº£n quyá»n cá»§a dá»± Ã¡n.
â”œâ”€â”€ package.json               # File cáº¥u hÃ¬nh npm, liá»‡t kÃª cÃ¡c gÃ³i JavaScript phá»¥ thuá»™c.
â”œâ”€â”€ phinx.php                  # File cáº¥u hÃ¬nh Phinx cho viá»‡c quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u.
â”œâ”€â”€ .php-cs-fixer.dist.php     # File cáº¥u hÃ¬nh PHP-CS-Fixer Ä‘á»ƒ Ä‘áº£m báº£o chuáº©n mÃ£ nguá»“n PHP.
â”œâ”€â”€ postcss.config.js          # File cáº¥u hÃ¬nh PostCSS.
â”œâ”€â”€ README.md                  # HÆ°á»›ng dáº«n sá»­ dá»¥ng framework `phpure`.
â”œâ”€â”€ tailwind.config.js         # File cáº¥u hÃ¬nh Tailwind CSS.
â”œâ”€â”€ webpack.config.js          # File cáº¥u hÃ¬nh Webpack cho viá»‡c Ä‘Ã³ng gÃ³i tÃ i nguyÃªn.
```

Táº¡i thá» Ä‘iá»ƒm nÃ y, cÃ³ thá»ƒ cáº¥u trÃºc thÆ° má»¥c cá»§a `phpure` váº«n cÃ²n khÃ¡ má»›i máº» vÃ  phá»©c táº¡p. NhÆ°ng Ä‘á»«ng lo, chÃºng ta sáº½ Ä‘i sÃ¢u vÃ o tá»«ng pháº§n trong cÃ¡c pháº§n tiáº¿p theo Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch hoáº¡t Ä‘á»™ng vÃ  sá»­ dá»¥ng cá»§a tá»«ng thÃ nh pháº§n.

---

## **TÄƒng Tá»‘c** ğŸ¤¾

Äá»ƒ thá»±c sá»± hiá»ƒu rÃµ vÃ  táº­n dá»¥ng tá»‘i Ä‘a `phpure`, báº¡n cáº§n hiá»ƒu rÃµ má»™t sá»‘ khÃ¡i niá»‡m cÆ¡ báº£n vÃ  cÃ¡ch
hoáº¡t Ä‘á»™ng cá»§a framework. Äáº§u tiÃªn lÃ  **vÃ²ng Ä‘á»i cá»§a request**.

### **1. Luá»“ng hoáº¡t Ä‘á»™ng vÃ  MÃ´ hÃ¬nh MVC - VÃ²ng Ä‘á»i cá»§a request** ğŸ”„

`phpure` hoáº¡t Ä‘á»™ng dá»±a trÃªn mÃ´ hÃ¬nh MVC (Model-View-Controller), má»™t kiáº¿n trÃºc phá»• biáº¿n trong phÃ¡t
triá»ƒn web giÃºp tÃ¡ch biá»‡t rÃµ rÃ ng cÃ¡c pháº§n cá»§a á»©ng dá»¥ng. **Model** chá»‹u trÃ¡ch nhiá»‡m quáº£n lÃ½ dá»¯
liá»‡u vÃ  logic nghiá»‡p vá»¥, **View** quáº£n lÃ½ giao diá»‡n ngÆ°á»i dÃ¹ng, cÃ²n **Controller** lÃ  cáº§u ná»‘i
giá»¯a Model vÃ  View, xá»­ lÃ½ cÃ¡c yÃªu cáº§u tá»« ngÆ°á»i dÃ¹ng vÃ  tráº£ vá» pháº£n há»“iphÃ¹ há»£p.

#### **Tiáº¿p nháº­n request:**

Má»i request tá»« trÃ¬nh duyá»‡t Ä‘Æ°á»£c gá»­i Ä‘áº¿n file `index.php` trong thÆ° má»¥c `public`. ÄÃ¢y lÃ  Ä‘iá»ƒm
vÃ o chÃ­nh cá»§a á»©ng dá»¥ng. Táº¡i Ä‘Ã¢y, framework Ä‘Æ°á»£c khá»Ÿi cháº¡y thÃ´ng qua phÆ°Æ¡ng thá»©c
`App::bootstrap()`, nÆ¡i cÃ¡c thÃ nh pháº§n quan trá»ng nhÆ° router, middleware, vÃ  session, ... Ä‘Æ°á»£c
cáº¥u hÃ¬nh.

#### **Router phÃ¢n tÃ­ch request:**

Sau khi khá»Ÿi Ä‘á»™ng, router chá»‹u trÃ¡ch nhiá»‡m Ã¡nh xáº¡ URL tá»« request Ä‘áº¿n cÃ¡c route Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a
trÆ°á»›c trong file `routes.php`. Router kiá»ƒm tra xem URL yÃªu cáº§u cÃ³ khá»›p vá»›i báº¥t ká»³ route nÃ o Ä‘Ã£
Ä‘Äƒng kÃ½ khÃ´ng. Náº¿u khÃ´ng tÃ¬m tháº¥y, nÃ³ sáº½ tráº£ vá» lá»—i 404.

#### **Xá»­ lÃ½ middleware:**

TrÆ°á»›c khi router gá»i controller, middleware Ä‘Æ°á»£c kÃ­ch hoáº¡t náº¿u nhÆ° route cÃ³ gáº¯n middlware.
Middleware lÃ  cÃ¡c lá»›p xá»­ lÃ½ trung gian, dÃ¹ng Ä‘á»ƒ kiá»ƒm tra hoáº·c thay Ä‘á»•i request trÆ°á»›c khi chuyá»ƒn
tiáº¿p. VÃ­ dá»¥, middleware cÃ³ thá»ƒ kiá»ƒm tra xem ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng nháº­p chÆ°a (auth) hoáº·c Ä‘áº£m báº£o ráº±ng
chá»‰ khÃ¡ch chÆ°a Ä‘Äƒng nháº­p má»›i cÃ³ thá»ƒ truy cáº­p má»™t sá»‘ trang nháº¥t Ä‘á»‹nh (guest). Náº¿u middleware phÃ¡t
hiá»‡n lá»—i, request sáº½ bá»‹ dá»«ng láº¡i vÃ  tráº£ vá» pháº£n há»“i ngay táº¡i Ä‘Ã³.

#### **Gá»i controller:**

Sau khi vÆ°á»£t qua middleware, router gá»i controller Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh cÃ¹ng vá»›i action (phÆ°Æ¡ng thá»©c cá»¥
thá»ƒ). Controller nháº­n cÃ¡c thÃ´ng tin tá»« request, xá»­ lÃ½ logic nghiá»‡p vá»¥, vÃ  chuáº©n bá»‹ dá»¯ liá»‡u Ä‘á»ƒ
truyá»n cho View. VÃ­ dá»¥, má»™t controller cÃ³ thá»ƒ láº¥y dá»¯ liá»‡u ngÆ°á»i dÃ¹ng tá»« cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c kiá»ƒm
tra Ä‘iá»u kiá»‡n nghiá»‡p vá»¥ trÆ°á»›c khi tiáº¿p tá»¥c.

#### **Káº¿t ná»‘i vá»›i View thÃ´ng qua Twig:**

Sau khi xá»­ lÃ½, controller thÆ°á»ng káº¿t thÃºc báº±ng viá»‡c gá»i má»™t template Ä‘á»ƒ hiá»ƒn thá»‹ giao diá»‡n.
`phpure` sá»­ dá»¥ng Twig, má»™t cÃ´ng cá»¥ template máº¡nh máº½, Ä‘á»ƒ káº¿t há»£p dá»¯ liá»‡u tá»« controller vÃ  cÃ¡c
template HTML Ä‘Ã£ Ä‘á»‹nh nghÄ©a. Twig cung cáº¥p nhiá»u tÃ­nh nÄƒng há»¯u Ã­ch nhÆ° vÃ²ng láº·p, kiá»ƒm tra Ä‘iá»u
kiá»‡n, vÃ  káº¿ thá»«a layout, giÃºp viá»‡c xÃ¢y dá»±ng giao diá»‡n dá»… dÃ ng vÃ  linh hoáº¡t.

#### **Tráº£ vá» response:**

Sau khi Twig táº¡o ra giao diá»‡n hoÃ n chá»‰nh (HTML), framework gá»­i ná»™i dung Ä‘Ã³ trá»Ÿ láº¡i trÃ¬nh duyá»‡t
dÆ°á»›i dáº¡ng response. NgÆ°á»i dÃ¹ng sáº½ tháº¥y trang web Ä‘Æ°á»£c hiá»ƒn thá»‹, hoÃ n chá»‰nh vá»›i dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c
xá»­ lÃ½ tá»« controller.

#### **TÃ³m láº¡i**

VÃ²ng Ä‘á»i cá»§a má»™t request trong `phpure` bao gá»“m cÃ¡c bÆ°á»›c tá»« tiáº¿p nháº­n URL, phÃ¢n tÃ­ch vÃ  Ã¡nh xáº¡
route, kiá»ƒm tra middleware, xá»­ lÃ½ logic trong controller, vÃ  cuá»‘i cÃ¹ng lÃ  render giao diá»‡n thÃ´ng
qua Twig. Kiáº¿n trÃºc MVC Ä‘áº£m báº£o má»—i pháº§n cá»§a á»©ng dá»¥ng cÃ³ nhiá»‡m vá»¥ rÃµ rÃ ng, giÃºp mÃ£ nguá»“n dá»… hiá»ƒu,
dá»… báº£o trÃ¬ vÃ  má»Ÿ rá»™ng. Vá»›i luá»“ng hoáº¡t Ä‘á»™ng máº¡ch láº¡c nÃ y, ngay cáº£ ngÆ°á»i má»›i báº¯t Ä‘áº§u cÅ©ng cÃ³ thá»ƒ
nhanh chÃ³ng hiá»ƒu Ä‘Æ°á»£c cÃ¡ch á»©ng dá»¥ng hoáº¡t Ä‘á»™ng vÃ  báº¯t tay vÃ o phÃ¡t triá»ƒn cÃ¡c tÃ­nh nÄƒng má»›i.

TÃ´i khuyÃªn báº¡n nÃªn Ä‘á»c qua mÃ£ nguá»“n cá»§a `phpure` Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a framework.
ÄÃ¢y lÃ  cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ há»c há»i vÃ  náº¯m vá»¯ng kiáº¿n thá»©c.

### **2. CÃ¡c chá»©c nÄƒng cá»‘t lÃµi** ğŸ¯

#### **Routing**

Routing lÃ  má»™t pháº§n quan trá»ng trong viá»‡c xÃ¡c Ä‘á»‹nh cÃ¡ch á»©ng dá»¥ng xá»­ lÃ½ cÃ¡c yÃªu cáº§u tá»« ngÆ°á»i dÃ¹ng.
`phpure` sá»­ dá»¥ng router Ä‘á»ƒ Ã¡nh xáº¡ URL Ä‘áº¿n cÃ¡c controller vÃ  action tÆ°Æ¡ng á»©ng. Táº¥t cáº£ cÃ¡c route cá»§a
á»©ng dá»¥ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong file `app/routes.php`. Äá»ƒ Ä‘á»‹nh nghÄ©a má»™t route, báº¡n
cáº§n chá»‰ Ä‘á»‹nh URL, phÆ°Æ¡ng thá»©c HTTP, controller vÃ  action tÆ°Æ¡ng á»©ng. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥:

```php
<?php

use Core\Http\Router;


$router = new Router();

// TODO: Define routes here
$router->get('', ['HomeController', 'index']); // ThÃªm dÃ²ng nÃ y

$router->dispatch();
```

Khi dÃ²ng `$router->get('', ['HomeController', 'index']);` Ä‘Æ°á»£c thÃªm vÃ o, nÃ³ sáº½ Ã¡nh xáº¡ URL rá»—ng
(`/`) Ä‘áº¿n phÆ°Æ¡ng thá»©c `index` cá»§a controller `HomeController`. Äiá»u nÃ y cÃ³ nghÄ©a
lÃ  khi ngÆ°á»i dÃ¹ng truy cáº­p trang chá»§ cá»§a á»©ng dá»¥ng, controller `HomeController` sáº½ Ä‘Æ°á»£c gá»i vÃ 
phÆ°Æ¡ng thá»©c `index` sáº½ Ä‘Æ°á»£c thá»±c thi.

Má»™t sá»‘ phÆ°Æ¡ng thá»©c routing phá»• biáº¿n khÃ¡c Ä‘Æ°á»£c tÃ­ch há»£p trong `phpure` bao gá»“m `post`, `put`,
`patch`, `delete`, ... Ä‘á»ƒ xá»­ lÃ½ cÃ¡c HTTP request khÃ¡c nhau. `phpure` cÅ©ng há»— trá»£ Ä‘á»‹nh nghÄ©a route
vá»›i tham sá»‘ Ä‘á»™ng, giÃºp xá»­ lÃ½ cÃ¡c URL Ä‘á»™ng má»™t cÃ¡ch dá»… dÃ ng. VÃ­ dá»¥ `'/posts/{id}'` sáº½ Ã¡nh xáº¡
URL `/posts/1`, `/posts/2`, ... Ä‘áº¿n cÃ¹ng má»™t controller vÃ  action nhÆ°ng vá»›i tham sá»‘ `id` khÃ¡c nhau,
Ä‘á»ƒ báº¡n truy xuáº¥t dá»¯ liá»‡u dá»±a trÃªn tham sá»‘ Ä‘Ã³. Xem vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y:

```php
$router->get('/posts/{id}', ['PostController', 'show']);
```

Vá»›i route nÃ y, URL `/posts/1` sáº½ gá»i phÆ°Æ¡ng thá»©c `show` cá»§a controller `PostController` vÃ  truyá»n
tham sá»‘ `1` vÃ o phÆ°Æ¡ng thá»©c Ä‘Ã³.

NgoÃ i ra, router cÃ²n há»— trá»£ middleware, middleware ngÄƒn cháº·n hoáº·c xá»­ lÃ½ yÃªu cáº§u trÆ°á»›c khi chÃºng
Ä‘áº¿n controller. Äiá»u nÃ y giÃºp báº¡n kiá»ƒm tra quyá»n truy cáº­p, xÃ¡c thá»±c ngÆ°á»i dÃ¹ng, hoáº·c thá»±c hiá»‡n cÃ¡c
tÃ¡c vá»¥ trÆ°á»›c khi xá»­ lÃ½ logic chÃ­nh. VÃ­ dá»¥:

```php
$router->get('/admin', ['AdminController', 'index'], ['auth']);
```

Trong Ä‘oáº¡n mÃ£ trÃªn, middleware `auth` sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t trÆ°á»›c khi yÃªu cáº§u Ä‘áº¿n controller
`AdminController`. Middleware nÃ y cÃ³ thá»ƒ kiá»ƒm tra xem ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng nháº­p chÆ°a, náº¿u chÆ°a sáº½
chuyá»ƒn hÆ°á»›ng ngÆ°á»i dÃ¹ng Ä‘áº¿n trang Ä‘Äƒng nháº­p. Náº¿u Ä‘Ã£ Ä‘Äƒng nháº­p, yÃªu cáº§u sáº½ Ä‘Æ°á»£c chuyá»ƒn tiáº¿p Ä‘áº¿n
controller Ä‘á»ƒ xá»­ lÃ½.

#### **Database vÃ  ORM** ğŸ’¾

`phpure` cung cáº¥p lá»›p `Database` Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u má»™t cÃ¡ch Ä‘Æ¡n giáº£n vÃ  hiá»‡u quáº£. Lá»›p nÃ y Ä‘Æ°á»£c láº¥y cáº£m há»©ng tá»« Query Builder cá»§a Laravel nhÆ°ng Ä‘Æ°á»£c Ä‘Æ¡n giáº£n hÃ³a Ä‘á»ƒ dá»… hiá»ƒu hÆ¡n. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng:

```php
// Láº¥y táº¥t cáº£ báº£n ghi tá»« báº£ng users
$users = Database::table('users')->get();

// Láº¥y ngÆ°á»i dÃ¹ng cÃ³ id = 1
$user = Database::table('users')->where('id', '=', 1)->first();

// ThÃªm ngÆ°á»i dÃ¹ng má»›i
Database::table('users')->insert([
    'name' => 'NgÆ°á»i dÃ¹ng má»›i',
    'email' => 'user@example.com',
    'password' => password_hash('password', PASSWORD_DEFAULT)
]);

// Cáº­p nháº­t thÃ´ng tin ngÆ°á»i dÃ¹ng
Database::table('users')
        ->where('id', '=', 1)
        ->update(['name' => 'TÃªn má»›i']);

// XÃ³a ngÆ°á»i dÃ¹ng
Database::table('users')
        ->where('id', '=', 1)
        ->delete();
```

NgoÃ i ra, `phpure` cÃ²n cung cáº¥p lá»›p `Model` trá»«u tÆ°á»£ng Ä‘á»ƒ báº¡n cÃ³ thá»ƒ táº¡o cÃ¡c model tÆ°Æ¡ng á»©ng vá»›i báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u. VÃ­ dá»¥:

```php
<?php

namespace App\Models;

use Core\Model;

class User extends Model
{
    protected string $table = 'users';
    protected bool $softDelete = true; // Há»— trá»£ xÃ³a má»m
}
```

Sau khi Ä‘á»‹nh nghÄ©a model, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u:

```php
// Láº¥y táº¥t cáº£ ngÆ°á»i dÃ¹ng
$users = User::all();

// TÃ¬m ngÆ°á»i dÃ¹ng theo ID
$user = User::find(1);

// ThÃªm ngÆ°á»i dÃ¹ng má»›i
$user = new User();
$user->create([
    'name' => 'NgÆ°á»i dÃ¹ng má»›i',
    'email' => 'user@example.com',
    'password' => password_hash('password', PASSWORD_DEFAULT)
]);

// Cáº­p nháº­t thÃ´ng tin
$user->update(['name' => 'TÃªn má»›i'], 1);

// XÃ³a ngÆ°á»i dÃ¹ng
$user->delete(1);
```

Äáº·c biá»‡t, lá»›p `Model` cÃ²n há»— trá»£ cÃ¡c má»‘i quan há»‡ giá»¯a cÃ¡c báº£ng nhÆ° One-to-One, One-to-Many vÃ  Many-to-Many:

```php
// Äá»‹nh nghÄ©a quan há»‡ trong model User
public function posts()
{
    return $this->hasMany(Post::class, 'user_id');
}

// Sá»­ dá»¥ng quan há»‡
$user = User::find(1);
$posts = $user->posts();
```

#### **Controllers** ğŸ®

CÃ¡c controller trong `phpure` káº¿ thá»«a tá»« lá»›p `Controller` cÆ¡ sá»Ÿ vÃ  chá»‹u trÃ¡ch nhiá»‡m xá»­ lÃ½ logic nghiá»‡p vá»¥ cá»§a á»©ng dá»¥ng. VÃ­ dá»¥ vá» má»™t controller Ä‘Æ¡n giáº£n:

```php
<?php

namespace App\Controllers;

use Core\Controller;
use App\Models\User;

class UserController extends Controller
{
    public function index()
    {
        $users = User::all();

        $this->render('users/index', [
            'users' => $users
        ]);
    }

    public function show($id)
    {
        $user = User::find($id);

        if (!$user) {
            abort(404);
        }

        $this->render('users/show', [
            'user' => $user
        ]);
    }

    public function create()
    {
        $this->render('users/create');
    }

    public function store()
    {
        // Xá»­ lÃ½ thÃªm ngÆ°á»i dÃ¹ng má»›i
    }
}
```

#### **Validation** âœ…

`phpure` tÃ­ch há»£p thÆ° viá»‡n [Respect/Validation](https://respect-validation.readthedocs.io/) Ä‘á»ƒ há»— trá»£ viá»‡c kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o má»™t cÃ¡ch Ä‘Æ¡n giáº£n vÃ  máº¡nh máº½. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng:

```php
<?php

namespace App\Controllers;

use Core\Controller;
use Core\Validation;
use Respect\Validation\Validator as v;

class AuthController extends Controller
{
    public function register()
    {
        $this->render('auth/register');
    }

    public function postRegister()
    {
        $validation = new Validation();

        $validation->validate([
            'name' => v::notEmpty()->length(2, 50),
            'email' => v::notEmpty()->email(),
            'password' => v::notEmpty()->length(8, null)
        ]);

        if ($validation->failed()) {
            $this->render('auth/register', [
                'errors' => $validation->getErrors()
            ]);
            return;
        }

        // Xá»­ lÃ½ Ä‘Äƒng kÃ½
    }
}
```

#### **Template Engine (Twig)** ğŸ–Œï¸

`phpure` sá»­ dá»¥ng [Twig](https://twig.symfony.com/) lÃ m template engine máº·c Ä‘á»‹nh. Twig cung cáº¥p má»™t cÃº phÃ¡p Ä‘Æ¡n giáº£n vÃ  máº¡nh máº½ Ä‘á»ƒ táº¡o cÃ¡c view. VÃ­ dá»¥ vá» má»™t file template Twig:

```twig
{# resources/views/users/index.html.twig #}
{% extends 'layouts/app.html.twig' %}

{% block content %}
    <h1>Danh sÃ¡ch ngÆ°á»i dÃ¹ng</h1>

    <ul>
        {% for user in users %}
            <li>{{ user.name }} - {{ user.email }}</li>
        {% else %}
            <li>KhÃ´ng cÃ³ ngÆ°á»i dÃ¹ng nÃ o.</li>
        {% endfor %}
    </ul>
{% endblock %}
```

Trong controller, báº¡n cÃ³ thá»ƒ render view vÃ  truyá»n dá»¯ liá»‡u nhÆ° sau:

```php
$this->render('users/index', [
    'users' => $users
]);
```

#### **Migrations vÃ  Seeds** ğŸŒ±

`phpure` sá»­ dá»¥ng [Phinx](https://phinx.org/) Ä‘á»ƒ quáº£n lÃ½ migrations vÃ  seeds. ÄÃ¢y lÃ  má»™t cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ quáº£n lÃ½ cáº¥u trÃºc cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  dá»¯ liá»‡u máº«u.

##### **Táº¡o migration má»›i**

```bash
vendor/bin/phinx create CreateUsersTable
```

Sau Ä‘Ã³, báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cáº¥u trÃºc báº£ng trong file migration:

```php
<?php

use Phinx\Migration\AbstractMigration;

class CreateUsersTable extends AbstractMigration
{
    public function change()
    {
        $table = $this->table('users');
        $table->addColumn('name', 'string', ['limit' => 50])
              ->addColumn('email', 'string', ['limit' => 100])
              ->addColumn('password', 'string')
              ->addColumn('created_at', 'datetime')
              ->addColumn('updated_at', 'datetime', ['null' => true])
              ->addColumn('deleted_at', 'datetime', ['null' => true])
              ->addIndex(['email'], ['unique' => true])
              ->create();
    }
}
```

##### **Cháº¡y migrations**

```bash
vendor/bin/phinx migrate
```

##### **Táº¡o seeder**

```bash
vendor/bin/phinx seed:create UserSeeder
```

Äá»‹nh nghÄ©a dá»¯ liá»‡u máº«u trong seeder:

```php
<?php

use Phinx\Seed\AbstractSeed;

class UserSeeder extends AbstractSeed
{
    public function run()
    {
        $faker = \Faker\Factory::create();
        $data = [];

        for ($i = 0; $i < 10; $i++) {
            $data[] = [
                'name' => $faker->name,
                'email' => $faker->email,
                'password' => password_hash('password', PASSWORD_DEFAULT),
                'created_at' => date('Y-m-d H:i:s')
            ];
        }

        $this->table('users')
             ->insert($data)
             ->saveData();
    }
}
```

##### **Cháº¡y seeds**

```bash
vendor/bin/phinx seed:run
```

#### **Middleware** ğŸ”„

Middleware lÃ  má»™t lá»›p xá»­ lÃ½ trung gian giá»¯a request vÃ  response, cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra quyá»n truy cáº­p, xÃ¡c thá»±c ngÆ°á»i dÃ¹ng, vÃ  nhiá»u tÃ¡c vá»¥ khÃ¡c. VÃ­ dá»¥ vá» má»™t middleware Ä‘Æ¡n giáº£n:

```php
<?php

namespace App\Middlewares;

use Core\Http\Middleware;
use Core\Session;

class AuthMiddleware extends Middleware
{
    public function handle(): bool
    {
        if (!Session::has('user_id')) {
            redirect('/login');
            return false;
        }

        return true;
    }
}
```

Äá»ƒ sá»­ dá»¥ng middleware, báº¡n cáº§n Ä‘Äƒng kÃ½ nÃ³ trong file `core/Http/Middleware.php` vÃ  sau Ä‘Ã³ sá»­ dá»¥ng nÃ³ trong route:

```php
// ÄÄƒng kÃ½ middleware
Middleware::register('auth', \App\Middlewares\AuthMiddleware::class);

// Sá»­ dá»¥ng middleware trong route
$router->get('/admin', ['AdminController', 'index'])->middleware('auth');
```

#### **Events vÃ  Listeners** ğŸ“¢

`phpure` há»— trá»£ há»‡ thá»‘ng sá»± kiá»‡n (events) vÃ  ngÆ°á»i láº¯ng nghe sá»± kiá»‡n (listeners). Äiá»u nÃ y cho phÃ©p báº¡n tÃ¡ch biá»‡t cÃ¡c thÃ nh pháº§n cá»§a á»©ng dá»¥ng vÃ  tÄƒng tÃ­nh báº£o trÃ¬.

```php
// ÄÄƒng kÃ½ event vÃ  listener trong file app/events.php
<?php

use Core\Event;

// ÄÄƒng kÃ½ cÃ¡c events vÃ  listeners
Event::listen('user.registered', \App\Listeners\SendWelcomeEmail::class);
```

KÃ­ch hoáº¡t event tá»« controller:

```php
Event::fire('user.registered', ['user' => $user]);
```

Äá»‹nh nghÄ©a listener:

```php
<?php

namespace App\Listeners;

class SendWelcomeEmail
{
    public function handle($data)
    {
        $user = $data['user'];
        // Gá»­i email chÃ o má»«ng
    }
}
```

## **KhÃ¡m phÃ¡ cÃ¡c tÃ­nh nÄƒng há»¯u Ã­ch** ğŸ”

NgoÃ i cÃ¡c tÃ­nh nÄƒng cá»‘t lÃµi Ä‘Ã£ trÃ¬nh bÃ y, `phpure` cÃ²n cung cáº¥p nhiá»u cÃ´ng cá»¥ há»¯u Ã­ch khÃ¡c Ä‘á»ƒ giÃºp báº¡n phÃ¡t triá»ƒn á»©ng dá»¥ng nhanh chÃ³ng vÃ  dá»… dÃ ng. Trong pháº§n nÃ y, chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» má»™t sá»‘ tÃ­nh nÄƒng thÃº vá»‹ nÃ y.

### **1. ThÃ´ng bÃ¡o Flash Message** ğŸ’¬

Flash message lÃ  thÃ´ng bÃ¡o táº¡m thá»i hiá»ƒn thá»‹ má»™t láº§n sau khi Ä‘iá»u hÆ°á»›ng trang, ráº¥t há»¯u Ã­ch Ä‘á»ƒ thÃ´ng bÃ¡o káº¿t quáº£ cá»§a má»™t hÃ nh Ä‘á»™ng. `phpure` cung cáº¥p phÆ°Æ¡ng thá»©c `flash()` trong lá»›p `Session` Ä‘á»ƒ quáº£n lÃ½ cÃ¡c thÃ´ng bÃ¡o nÃ y:

```php
// Äáº·t thÃ´ng bÃ¡o flash trong controller
Session::flash('success', 'ÄÄƒng kÃ½ tÃ i khoáº£n thÃ nh cÃ´ng!');
redirect('/login');

// Trong view, hiá»ƒn thá»‹ thÃ´ng bÃ¡o (vá»›i Twig)
{% if flash('success') %}
    <div class="alert alert-success">
        {{ flash('success') }}
    </div>
{% endif %}
```

ThÃ´ng bÃ¡o flash ráº¥t há»¯u Ã­ch trong cÃ¡c tÃ¬nh huá»‘ng nhÆ°:

- Hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng sau khi thÃªm, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u
- Hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i sau khi chuyá»ƒn hÆ°á»›ng
- Hiá»ƒn thá»‹ hÆ°á»›ng dáº«n hoáº·c thÃ´ng tin táº¡m thá»i cho ngÆ°á»i dÃ¹ng

### **2. Quáº£n lÃ½ Form vÃ  Báº£o máº­t CSRF** ğŸ”’

`phpure` cung cáº¥p lá»›p `Form` Ä‘á»ƒ há»— trá»£ viá»‡c táº¡o vÃ  báº£o máº­t cÃ¡c biá»ƒu máº«u HTML. Äáº·c biá»‡t, lá»›p nÃ y cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c Ä‘á»ƒ táº¡o token CSRF (Cross-Site Request Forgery) Ä‘á»ƒ báº£o vá»‡ á»©ng dá»¥ng cá»§a báº¡n khá»i cÃ¡c cuá»™c táº¥n cÃ´ng giáº£ máº¡o yÃªu cáº§u.

```php
// Trong controller, táº¡o view vá»›i form
public function create()
{
    $this->render('users/create');
}

// Trong view (users/create.html.twig)
<form method="post" action="{{ url('/users/store') }}">
    <input type="hidden" name="csrf_token" value="{{ form_token() }}">

    <div class="form-group">
        <label for="name">TÃªn:</label>
        {{ form_input('text', 'name', '', {'class': 'form-control', 'required': 'required'}) }}
    </div>

    <div class="form-group">
        <label for="email">Email:</label>
        {{ form_input('email', 'email', '', {'class': 'form-control', 'required': 'required'}) }}
    </div>

    <button type="submit" class="btn btn-primary">ÄÄƒng kÃ½</button>
</form>

// Trong controller xá»­ lÃ½ form
public function store()
{
    // Kiá»ƒm tra token CSRF
    $token = Request::input('csrf_token');
    if (!Form::validateToken($token)) {
        Session::flash('error', 'Token khÃ´ng há»£p lá»‡!');
        redirect('/users/create');
        return;
    }

    // Xá»­ lÃ½ dá»¯ liá»‡u form
    // ...
}
```

### **3. PhÃ¢n trang (Pagination)** ğŸ“‹

PhÃ¢n trang lÃ  tÃ­nh nÄƒng quan trá»ng khi hiá»ƒn thá»‹ má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u. `phpure` cung cáº¥p lá»›p `Pagination` Ä‘á»ƒ giÃºp báº¡n dá»… dÃ ng triá»ƒn khai phÃ¢n trang trong á»©ng dá»¥ng cá»§a mÃ¬nh:

```php
// Trong controller
public function index()
{
    $currentPage = (int) Request::query('page', 1);
    $perPage = 10;

    // Láº¥y tá»•ng sá»‘ báº£n ghi
    $total = Database::table('users')->count();

    // Khá»Ÿi táº¡o Ä‘á»‘i tÆ°á»£ng Pagination
    $pagination = new Pagination($total, $perPage, $currentPage);

    // Láº¥y dá»¯ liá»‡u vá»›i phÃ¢n trang
    $users = Database::table('users')
                   ->orderBy('id', 'DESC')
                   ->limit($perPage)
                   ->offset($pagination->offset())
                   ->get();

    $this->render('users/index', [
        'users' => $users,
        'pagination' => $pagination->links()
    ]);
}

// Trong view (users/index.html.twig)
{# Hiá»ƒn thá»‹ danh sÃ¡ch ngÆ°á»i dÃ¹ng #}
<ul>
    {% for user in users %}
        <li>{{ user.name }} - {{ user.email }}</li>
    {% else %}
        <li>KhÃ´ng cÃ³ ngÆ°á»i dÃ¹ng nÃ o.</li>
    {% endfor %}
</ul>

{# Hiá»ƒn thá»‹ phÃ¢n trang #}
<nav>
    <ul class="pagination">
        {% for link in pagination %}
            <li class="page-item {{ link.active ? 'active' : '' }}">
                <a class="page-link" href="{{ link.url }}">{{ link.page }}</a>
            </li>
        {% endfor %}
    </ul>
</nav>
```

### **4. Bá»™ nhá»› Ä‘á»‡m (Cache)** âš¡

Cache giÃºp tÄƒng hiá»‡u suáº¥t á»©ng dá»¥ng báº±ng cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u táº¡m thá»i, trÃ¡nh pháº£i thá»±c hiá»‡n cÃ¡c thao tÃ¡c tá»‘n kÃ©m nhÆ° truy váº¥n cÆ¡ sá»Ÿ dá»¯ liá»‡u nhiá»u láº§n. `phpure` cung cáº¥p má»™t lá»›p `Cache` Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£:

```php
// LÆ°u dá»¯ liá»‡u vÃ o cache
Cache::put('users', $users, 60); // LÆ°u trong 60 phÃºt

// Láº¥y dá»¯ liá»‡u tá»« cache
$users = Cache::get('users');

// VÃ­ dá»¥ thá»±c táº¿: Láº¥y danh sÃ¡ch ngÆ°á»i dÃ¹ng tá»« cache hoáº·c database
public function index()
{
    // Thá»­ láº¥y dá»¯ liá»‡u tá»« cache
    $users = Cache::get('users');

    // Náº¿u khÃ´ng cÃ³ trong cache, láº¥y tá»« database vÃ  lÆ°u vÃ o cache
    if (!$users) {
        $users = User::all();
        Cache::put('users', $users, 30); // LÆ°u trong 30 phÃºt
    }

    $this->render('users/index', [
        'users' => $users
    ]);
}

// XÃ³a cache
Cache::delete('users');

// XÃ³a táº¥t cáº£ cache
Cache::flush();
```

### **5. Xá»­ lÃ½ lá»—i nÃ¢ng cao** ğŸ› ï¸

`phpure` cung cáº¥p lá»›p `ExceptionHandler` Ä‘á»ƒ xá»­ lÃ½ lá»—i má»™t cÃ¡ch hiá»‡u quáº£. Lá»›p nÃ y tá»± Ä‘á»™ng báº¯t cÃ¡c lá»—i vÃ  exception, ghi log vÃ  hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i phÃ¹ há»£p vá»›i mÃ´i trÆ°á»ng:

```php
// ÄÄƒng kÃ½ exception handler trong file bootstrap
ExceptionHandler::register();

// Khi cÃ³ lá»—i xáº£y ra:
// - Trong mÃ´i trÆ°á»ng development: Hiá»ƒn thá»‹ chi tiáº¿t lá»—i
// - Trong mÃ´i trÆ°á»ng production: Hiá»ƒn thá»‹ trang lá»—i thÃ¢n thiá»‡n vá»›i ngÆ°á»i dÃ¹ng
```

Äá»ƒ táº¡o trang lá»—i tÃ¹y chá»‰nh, báº¡n cÃ³ thá»ƒ táº¡o cÃ¡c file view tÆ°Æ¡ng á»©ng trong thÆ° má»¥c `resources/views/errors/`:

- `404.html.twig` - Trang khÃ´ng tÃ¬m tháº¥y
- `500.html.twig` - Lá»—i server

### **6. Lá»c dá»¯ liá»‡u Ä‘áº§u vÃ o an toÃ n** ğŸ”

`phpure` má»Ÿ rá»™ng lá»›p `Request` vá»›i phÆ°Æ¡ng thá»©c `sanitize()` Ä‘á»ƒ lá»c dá»¯ liá»‡u Ä‘áº§u vÃ o, báº£o vá»‡ á»©ng dá»¥ng khá»i cÃ¡c mÃ£ Ä‘á»™c háº¡i:

```php
// Láº¥y dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Ã£ Ä‘Æ°á»£c lá»c
$name = Request::sanitize('name');
$email = Request::sanitize('email');

// Kiá»ƒm tra xem yÃªu cáº§u cÃ³ pháº£i Ajax khÃ´ng
if (Request::isAjax()) {
    // Xá»­ lÃ½ yÃªu cáº§u Ajax
}

// Láº¥y Ä‘á»‹a chá»‰ IP cá»§a ngÆ°á»i dÃ¹ng
$userIp = Request::ip();
```

### **7. HÆ°á»›ng dáº«n xá»­ lÃ½ tá»‡p táº£i lÃªn** ğŸ“

`phpure` cung cáº¥p lá»›p `Storage` Ä‘á»ƒ quáº£n lÃ½ viá»‡c táº£i lÃªn vÃ  lÆ°u trá»¯ tá»‡p. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ hoÃ n chá»‰nh vá» cÃ¡ch xá»­ lÃ½ tá»‡p táº£i lÃªn:

```php
// Trong view (form táº£i lÃªn)
<form method="post" action="{{ url('/upload') }}" enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ form_token() }}">

    <div class="form-group">
        <label for="avatar">áº¢nh Ä‘áº¡i diá»‡n:</label>
        <input type="file" name="avatar" id="avatar">
    </div>

    <button type="submit" class="btn btn-primary">Táº£i lÃªn</button>
</form>

// Trong controller
public function upload()
{
    // Kiá»ƒm tra token CSRF
    $token = Request::input('csrf_token');
    if (!Form::validateToken($token)) {
        Session::flash('error', 'Token khÃ´ng há»£p lá»‡!');
        redirect('/profile');
        return;
    }

    // Kiá»ƒm tra file táº£i lÃªn
    if (!isset($_FILES['avatar']) || $_FILES['avatar']['error'] !== UPLOAD_ERR_OK) {
        Session::flash('error', 'Lá»—i khi táº£i lÃªn tá»‡p!');
        redirect('/profile');
        return;
    }

    // Táº¡o tÃªn file ngáº«u nhiÃªn
    $extension = pathinfo($_FILES['avatar']['name'], PATHINFO_EXTENSION);
    $filename = uniqid() . '.' . $extension;

    // LÆ°u file
    $storagePath = 'avatars/' . $filename;
    $filepath = Storage::put($storagePath, $_FILES['avatar']);

    // Cáº­p nháº­t profile cá»§a ngÆ°á»i dÃ¹ng
    $userId = Session::get('user_id');
    User::update(['avatar' => $storagePath], $userId);

    Session::flash('success', 'Táº£i lÃªn áº£nh Ä‘áº¡i diá»‡n thÃ nh cÃ´ng!');
    redirect('/profile');
}
```

## **XÃ¢y dá»±ng á»©ng dá»¥ng Ä‘áº§u tiÃªn vá»›i phpure** ğŸ—ï¸

Trong pháº§n nÃ y, chÃºng ta sáº½ xÃ¢y dá»±ng má»™t á»©ng dá»¥ng Todo List Ä‘Æ¡n giáº£n Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch sá»­ dá»¥ng `phpure` trong thá»±c táº¿.

### **BÆ°á»›c 1: Thiáº¿t láº­p cÆ¡ sá»Ÿ dá»¯ liá»‡u**

Äáº§u tiÃªn, táº¡o má»™t migration Ä‘á»ƒ táº¡o báº£ng `todos`:

```bash
vendor/bin/phinx create CreateTodosTable
```

Sau Ä‘Ã³, Ä‘á»‹nh nghÄ©a báº£ng trong file migration:

```php
<?php

use Phinx\Migration\AbstractMigration;

class CreateTodosTable extends AbstractMigration
{
    public function change()
    {
        $table = $this->table('todos');
        $table->addColumn('title', 'string', ['limit' => 255])
              ->addColumn('completed', 'boolean', ['default' => false])
              ->addColumn('user_id', 'integer', ['null' => true])
              ->addColumn('created_at', 'datetime')
              ->addColumn('updated_at', 'datetime', ['null' => true])
              ->addIndex(['user_id'])
              ->create();
    }
}
```

Thá»±c thi migration:

```bash
vendor/bin/phinx migrate
```

### **BÆ°á»›c 2: Táº¡o Model**

Táº¡o file `app/Models/Todo.php`:

```php
<?php

namespace App\Models;

use Core\Model;

class Todo extends Model
{
    protected string $table = 'todos';
}
```

### **BÆ°á»›c 3: Táº¡o Controller**

Táº¡o file `app/Controllers/TodoController.php`:

```php
<?php

namespace App\Controllers;

use Core\Controller;
use Core\Http\Request;
use Core\Session;
use Core\Validation;
use App\Models\Todo;
use Respect\Validation\Validator as v;

class TodoController extends Controller
{
    public function index()
    {
        $todos = Todo::all();

        $this->render('todos/index', [
            'todos' => $todos
        ]);
    }

    public function create()
    {
        $this->render('todos/create');
    }

    public function store()
    {
        $validation = new Validation();
        $validation->validate([
            'title' => v::notEmpty()->length(3, 255)
        ]);

        if ($validation->failed()) {
            Session::flash('errors', $validation->errors());
            redirect('/todos/create');
            return;
        }

        $todo = new Todo();
        $todo->create([
            'title' => Request::sanitize('title'),
            'completed' => false,
            'user_id' => Session::get('user_id') ?? null,
            'created_at' => date('Y-m-d H:i:s')
        ]);

        Session::flash('success', 'ThÃªm cÃ´ng viá»‡c thÃ nh cÃ´ng!');
        redirect('/todos');
    }

    public function toggle($id)
    {
        $todo = Todo::find($id);

        if (!$todo) {
            abort(404);
        }

        $todo->update([
            'completed' => !$todo->completed,
            'updated_at' => date('Y-m-d H:i:s')
        ], $id);

        redirect('/todos');
    }

    public function delete($id)
    {
        $todo = Todo::find($id);

        if (!$todo) {
            abort(404);
        }

        $todo->delete($id);

        Session::flash('success', 'XÃ³a cÃ´ng viá»‡c thÃ nh cÃ´ng!');
        redirect('/todos');
    }
}
```

### **BÆ°á»›c 4: Äá»‹nh nghÄ©a Routes**

Trong file `app/routes.php`:

```php
<?php

use Core\Http\Router;

$router = new Router();

// Trang chá»§
$router->get('', ['HomeController', 'index']);

// Routes cho Todo
$router->get('todos', ['TodoController', 'index']);
$router->get('todos/create', ['TodoController', 'create']);
$router->post('todos', ['TodoController', 'store']);
$router->get('todos/{id}/toggle', ['TodoController', 'toggle']);
$router->get('todos/{id}/delete', ['TodoController', 'delete']);

$router->dispatch();
```

### **BÆ°á»›c 5: Táº¡o Views**

Táº¡o file `resources/views/todos/index.html.twig`:

```twig
{% extends 'layouts/app.html.twig' %}

{% block content %}
    <div class="container mt-5">
        <h1 class="mb-4">Danh sÃ¡ch cÃ´ng viá»‡c</h1>

        {% if flash('success') %}
            <div class="alert alert-success">
                {{ flash('success') }}
            </div>
        {% endif %}

        <a href="{{ url('/todos/create') }}" class="btn btn-primary mb-3">ThÃªm cÃ´ng viá»‡c má»›i</a>

        <div class="list-group">
            {% for todo in todos %}
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        {% if todo.completed %}
                            <s>{{ todo.title }}</s>
                        {% else %}
                            {{ todo.title }}
                        {% endif %}
                    </div>
                    <div>
                        <a href="{{ url('/todos/' ~ todo.id ~ '/toggle') }}" class="btn btn-sm btn-info">
                            {% if todo.completed %}
                                ÄÃ¡nh dáº¥u chÆ°a hoÃ n thÃ nh
                            {% else %}
                                ÄÃ¡nh dáº¥u hoÃ n thÃ nh
                            {% endif %}
                        </a>
                        <a href="{{ url('/todos/' ~ todo.id ~ '/delete') }}" class="btn btn-sm btn-danger" onclick="return confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a?')">XÃ³a</a>
                    </div>
                </div>
            {% else %}
                <div class="alert alert-info">KhÃ´ng cÃ³ cÃ´ng viá»‡c nÃ o.</div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
```

Táº¡o file `resources/views/todos/create.html.twig`:

```twig
{% extends 'layouts/app.html.twig' %}

{% block content %}
    <div class="container mt-5">
        <h1 class="mb-4">ThÃªm cÃ´ng viá»‡c má»›i</h1>

        {% if flash('errors') %}
            <div class="alert alert-danger">
                <ul>
                    {% for field, errors in flash('errors') %}
                        {% for error in errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <form action="{{ url('/todos') }}" method="post">
            <input type="hidden" name="csrf_token" value="{{ form_token() }}">

            <div class="form-group">
                <label for="title">TÃªn cÃ´ng viá»‡c:</label>
                <input type="text" name="title" id="title" class="form-control" required>
            </div>

            <button type="submit" class="btn btn-primary mt-3">ThÃªm</button>
            <a href="{{ url('/todos') }}" class="btn btn-secondary mt-3">Há»§y</a>
        </form>
    </div>
{% endblock %}
```

Táº¡o file `resources/views/layouts/app.html.twig`:

```twig
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>á»¨ng dá»¥ng Todo List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url('/') }}">Todo App</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url('/') }}">Trang chá»§</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url('/todos') }}">CÃ´ng viá»‡c</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    {% block content %}{% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
```

Vá»›i vÃ­ dá»¥ thá»±c táº¿ nÃ y, báº¡n Ä‘Ã£ tháº¥y cÃ¡ch `phpure` hoáº¡t Ä‘á»™ng trong má»™t á»©ng dá»¥ng Ä‘áº§y Ä‘á»§ chá»©c nÄƒng. Báº¡n cÃ³ thá»ƒ má»Ÿ rá»™ng á»©ng dá»¥ng nÃ y báº±ng cÃ¡ch thÃªm chá»©c nÄƒng Ä‘Äƒng nháº­p, quáº£n lÃ½ ngÆ°á»i dÃ¹ng, hoáº·c báº¥t ká»³ tÃ­nh nÄƒng nÃ o khÃ¡c!

## **CÃ¡c ká»¹ thuáº­t nÃ¢ng cao** ğŸš€

### **1. LiÃªn káº¿t database vá»›i quan há»‡ nhiá»u-nhiá»u**

Äá»ƒ lÃ m viá»‡c vá»›i quan há»‡ nhiá»u-nhiá»u (many-to-many), báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `belongsToMany()` trong model:

```php
// Model User
public function roles()
{
    return $this->belongsToMany(
        Role::class,    // Model liÃªn quan
        'user_roles',   // Báº£ng trung gian
        'user_id',      // KhÃ³a ngoáº¡i cá»§a báº£ng hiá»‡n táº¡i
        'role_id',      // KhÃ³a ngoáº¡i cá»§a báº£ng liÃªn quan
        'id',           // KhÃ³a chÃ­nh cá»§a báº£ng hiá»‡n táº¡i
        'id'            // KhÃ³a chÃ­nh cá»§a báº£ng liÃªn quan
    );
}

// Sá»­ dá»¥ng
$user = User::find(1);
$roles = $user->roles();
```

### **2. Middleware kiá»ƒm tra vai trÃ² ngÆ°á»i dÃ¹ng**

Táº¡o middleware Ä‘á»ƒ kiá»ƒm tra vai trÃ² cá»§a ngÆ°á»i dÃ¹ng:

```php
<?php

namespace App\Middlewares;

use Core\Http\Middleware;
use Core\Session;
use App\Models\User;

class RoleMiddleware extends Middleware
{
    private array $allowedRoles;

    public function __construct(array $allowedRoles)
    {
        $this->allowedRoles = $allowedRoles;
    }

    public function handle(): bool
    {
        $userId = Session::get('user_id');

        if (!$userId) {
            redirect('/login');
            return false;
        }

        $user = User::find($userId);
        $userRoles = $user->roles();

        foreach ($userRoles as $role) {
            if (in_array($role->name, $this->allowedRoles)) {
                return true;
            }
        }

        abort(403); // KhÃ´ng cÃ³ quyá»n truy cáº­p
        return false;
    }
}

// ÄÄƒng kÃ½ middleware
Middleware::register('role', \App\Middlewares\RoleMiddleware::class);

// Sá»­ dá»¥ng trong route
$router->get('/admin', ['AdminController', 'index'])->middleware('role:admin,super_admin');
```

### **3. Táº¡o Command Line Interface (CLI)**

Báº¡n cÃ³ thá»ƒ táº¡o cÃ¡c lá»‡nh CLI cho `phpure` Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a cÃ¡c tÃ¡c vá»¥:

```php
<?php
// commands/generate.php

require_once __DIR__ . '/../vendor/autoload.php';
require_once __DIR__ . '/../utils/helpers.php';

// Xá»­ lÃ½ tham sá»‘ dÃ²ng lá»‡nh
$command = $argv[1] ?? null;
$name = $argv[2] ?? null;

if (!$command || !$name) {
    echo "Sá»­ dá»¥ng: php commands/generate.php [controller|model|middleware] [name]\n";
    exit(1);
}

switch ($command) {
    case 'controller':
        generateController($name);
        break;
    case 'model':
        generateModel($name);
        break;
    case 'middleware':
        generateMiddleware($name);
        break;
    default:
        echo "Lá»‡nh khÃ´ng há»£p lá»‡. CÃ¡c lá»‡nh há»£p lá»‡: controller, model, middleware\n";
        exit(1);
}

function generateController($name)
{
    $template = <<<PHP
<?php

namespace App\Controllers;

use Core\Controller;

class {$name}Controller extends Controller
{
    public function index()
    {
        \$this->render('{$name}s/index');
    }

    public function show(\$id)
    {
        \$this->render('{$name}s/show', ['id' => \$id]);
    }

    public function create()
    {
        \$this->render('{$name}s/create');
    }

    public function store()
    {
        // Xá»­ lÃ½ logic
    }
}
PHP;

    $filename = __DIR__ . "/../app/Controllers/{$name}Controller.php";
    file_put_contents($filename, $template);
    echo "Controller {$name}Controller Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng!\n";
}

// TÆ°Æ¡ng tá»± cho generateModel vÃ  generateMiddleware
```

Vá»›i nhá»¯ng vÃ­ dá»¥ vÃ  hÆ°á»›ng dáº«n cá»¥ thá»ƒ nÃ y, báº¡n Ä‘Ã£ cÃ³ má»™t bá»©c tranh toÃ n diá»‡n vá» framework `phpure` vÃ  cÃ¡ch sá»­ dá»¥ng nÃ³ Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i. HÃ£y báº¯t Ä‘áº§u thá»­ nghiá»‡m vÃ  khÃ¡m phÃ¡ thÃªm cÃ¡c kháº£ nÄƒng cá»§a framework!

## **Tá»•ng káº¿t** ğŸ“

`phpure` lÃ  má»™t framework MVC Ä‘Æ¡n giáº£n nhÆ°ng máº¡nh máº½, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘áº·c biá»‡t cho nhá»¯ng ngÆ°á»i má»›i há»c PHP. Vá»›i cáº¥u trÃºc rÃµ rÃ ng, tÃ i liá»‡u chi tiáº¿t vÃ  cÃ¡c vÃ­ dá»¥ cá»¥ thá»ƒ, `phpure` lÃ  lá»±a chá»n tuyá»‡t vá»i Ä‘á»ƒ báº¡n hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng bÃªn trong cá»§a má»™t framework web trÆ°á»›c khi chuyá»ƒn sang cÃ¡c framework lá»›n hÆ¡n nhÆ° Laravel.

Nhá»¯ng kiáº¿n thá»©c báº¡n há»c Ä‘Æ°á»£c tá»« `phpure` sáº½ lÃ  ná»n táº£ng vá»¯ng cháº¯c cho hÃ nh trÃ¬nh phÃ¡t triá»ƒn web cá»§a báº¡n, giÃºp báº¡n trá»Ÿ thÃ nh má»™t láº­p trÃ¬nh viÃªn PHP tá»‘t hÆ¡n.

HÃ£y tá»± tin khÃ¡m phÃ¡, thá»­ nghiá»‡m vÃ  Ä‘Ã³ng gÃ³p cho `phpure` Ä‘á»ƒ cÃ¹ng nhau xÃ¢y dá»±ng má»™t cá»™ng Ä‘á»“ng há»c táº­p máº¡nh máº½!

---

_Last updated: April 05, 2025_
